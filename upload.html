<!DOCTYPE html>
<html lang="en" style="background-color: #0a0a0a; min-height: 100%;">
<head>
  <meta charset="UTF-8">
  <!-- CRITICAL: Prevent iOS PWA white flash -->
  <style>
    html, body { background-color: #0a0a0a; min-height: 100%; }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Upload Request Form - Forensic Video Unit">
  <title>Upload Request - Forensic Video Unit</title>

  <!-- PWA Configuration -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1B3A6B">

  <!-- iOS PWA Support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="FVU Requests">

  <!-- iOS Icons -->
  <link rel="apple-touch-icon" href="/assets/images/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/icon-180x180.png">

  <!-- iOS Splash Screens - All Devices -->
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1640-2360.jpg" media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2360-1640.jpg" media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1488-2266.jpg" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2266-1488.jpg" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1320-2868.jpg" media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2868-1320.jpg" media="(device-width: 440px) and (device-height: 956px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1206-2622.jpg" media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2622-1206.jpg" media="(device-width: 402px) and (device-height: 874px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1260-2736.jpg" media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2736-1260.jpg" media="(device-width: 420px) and (device-height: 912px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)">

  <!-- Windows/Edge -->
  <meta name="msapplication-TileColor" content="#1B3A6B">
  <meta name="msapplication-TileImage" content="/assets/images/icons/icon-144x144.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icons/icon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icons/icon-16x16.png">

  <!-- CSS Files -->
  <link rel="stylesheet" href="assets/css/forms.css">
  <link rel="stylesheet" href="assets/css/header.css">
  <link rel="stylesheet" href="assets/css/notifications.css">

  <!-- Flatpickr CSS (bundled locally for security - no CDN) -->
  <link rel="stylesheet" href="lib/flatpickr.min.css">

  <!-- Early theme initialization to prevent FOUC -->
  <script>
    // Prevent flash of unstyled content by setting theme before body renders
    document.documentElement.setAttribute('data-theme',
      localStorage.getItem('fvu-theme') || 'dark');
  </script>

  <!-- Libraries -->
  <script src="lib/pdfmake.min.js"></script>
  <script src="lib/vfs_fonts.js"></script>
</head>
<body>
  <!-- Animated Background -->
  <div class="background-animation">
    <div class="grid-overlay"></div>
    <div class="floating-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>
  </div>

  <!-- Header injected by header-component.js -->

  <!-- Main Form Content -->
  <main class="container" style="padding: 2rem 1rem; max-width: 800px;">
    <form id="upload-form" novalidate>
      <!-- Hidden session field for PHP -->
      <!-- <input type="hidden" name="session_verify" value="<?php echo session_id(); ?>"> -->

      <!-- Evidence Information Section -->
      <section class="form-section" id="evidence-section-container">
        <!-- Built by JS via FormFieldBuilder -->
      </section>

      <!-- Submitting Investigator Information Section -->
      <section class="form-section" id="investigator-section-container">
        <!-- Built by JS via FormFieldBuilder -->
      </section>

      <!-- Location & Video Information -->
      <div id="location-video-container">
        <!-- All location-video groups (including first) built by JS -->
      </div>

      <!-- Add Location Button -->
      <div class="text-center" style="margin-top: 2rem; margin-bottom: 2rem;">
        <button type="button" id="addLocationBtn" class="btn btn-primary" style="min-width: 250px; font-size: 1.1rem; padding: 0.75rem 2rem;">
          <span style="font-size: 1.2em;">+</span> Add Another Location
        </button>
        <small class="form-text d-block mt-2">
          Add if the USB contains video from multiple locations with different timeframes
        </small>
      </div>

      <!-- Additional Information Section -->
      <section class="form-section" id="additional-section-container">
        <!-- Built by JS via FormFieldBuilder -->
      </section>

      <!-- Form Actions -->
      <div class="form-actions" style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
        <button type="submit" class="btn btn-primary" style="min-width: 150px;">
          Submit Request
        </button>
        <button type="reset" class="btn btn-secondary" style="min-width: 150px;">
          Clear Form
        </button>
      </div>
    </form>

    <!-- Progress Bar -->
    <div class="progress-container" style="position: fixed; bottom: 0; left: 0; right: 0; background: var(--surface-dark); padding: 1rem; border-top: 1px solid var(--border-color);">
      <div class="progress-label" style="text-align: center; margin-bottom: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">
        <span id="progress-percentage">0%</span> Complete
      </div>
      <div class="progress" style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
        <div class="progress-bar" id="form-progress" style="width: 0%; height: 100%; background: var(--color-danger); transition: all 0.3s ease; border-radius: 4px;"></div>
      </div>
    </div>
  </main>

  <!-- Flatpickr JS (bundled locally for security - no CDN) -->
  <script src="lib/flatpickr.min.js"></script>

  <!-- JavaScript Modules -->
  <script type="module">
    import { CONFIG } from './assets/js/config.js';
    import { UploadFormHandler } from './assets/js/form-handlers/form-handler-upload.js';
    import { initHeader } from './assets/js/header-component.js';
    import { initPWA } from './assets/js/pwa-register.js';

    // Initialize header with form title
    initHeader('Video Evidence Upload Request Form');

    // Initialize form handler
    const formHandler = new UploadFormHandler('upload-form');

    // Initialize PWA
    initPWA();
  </script>
</body>
</html>
